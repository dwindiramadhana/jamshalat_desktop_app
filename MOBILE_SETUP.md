# Mobile Build Setup for Jam Shalat App

This document explains how to set up mobile builds (Android APK and iOS IPA) with proper signing for the Jam Shalat prayer times app.

## Overview

The mobile setup includes:
- **Android APK** builds with automatic signing
- **iOS IPA** builds (requires Apple Developer account)
- **GitHub Actions** integration for automated builds
- **Local development** support

## Quick Setup

Run the setup script to initialize mobile platforms:

```bash
./setup-mobile.sh
```

## Manual Setup

### 1. Mobile Dependencies

The following have been added to support mobile builds:

**Cargo.toml:**
- `tauri = { version = "2.7.0", features = ["mobile"] }`
- Mobile plugins: `tauri-plugin-shell`, `tauri-plugin-fs`, `tauri-plugin-dialog`

**tauri.conf.json:**
- Bundle identifier changed to `com.jamshalat.app`
- iOS configuration with minimum system version 13.0
- Android configuration with minimum SDK version 24

### 2. Android Signing

**Keystore Creation:**
```bash
keytool -genkey -v -keystore ./android-release-key.jks \
    -keyalg RSA -keysize 2048 -validity 10000 \
    -alias jam-shalat-key \
    -dname "CN=Jam Shalat, OU=Development, O=Jam Shalat App, L=Jakarta, ST=Jakarta, C=ID" \
    -storepass jamshalat2024 -keypass jamshalat2024
```

**Signing Configuration:**
File: `src-tauri/gen/android/keystore.properties`
```properties
keyAlias=jam-shalat-key
password=jamshalat2024
storeFile=../../../android-release-key.jks
```

### 3. iOS Signing

**Requirements:**
- Apple Developer account ($99/year)
- Development team ID set in `tauri.conf.json`
- Xcode with command line tools

**Configuration:**
Update `tauri.conf.json`:
```json
{
  "bundle": {
    "iOS": {
      "developmentTeam": "YOUR_TEAM_ID_HERE"
    }
  }
}
```

## GitHub Actions Integration

The workflow now includes mobile builds:

### Build Matrix
- **Android**: Ubuntu runner with Android SDK and NDK
- **iOS**: macOS runner with Xcode tools
- **Desktop**: Existing Windows, macOS, Linux builds

### Mobile Artifacts
- **Android**: APK and AAB files in `src-tauri/gen/android/app/build/outputs/`
- **iOS**: IPA files in `src-tauri/gen/ios/build/Build/Products/`

### Signing in CI/CD
- **Android**: Automatic keystore creation and signing
- **iOS**: Development certificate signing (requires Apple Developer setup)

## Local Development

### Android Build
```bash
npm run tauri android init    # First time only
npm run tauri android build   # Build signed APK
```

### iOS Build
```bash
npm run tauri ios init        # First time only (requires Apple Developer)
npm run tauri ios build       # Build signed IPA
```

## Installation on Devices

### Android
1. Enable "Unknown Sources" in Settings → Security
2. Download and install the APK file
3. Grant necessary permissions

### iOS
1. Requires development certificate or jailbroken device
2. Install via Xcode, AltStore, or similar tools
3. Trust the developer certificate in Settings

## Security Notes

- **Keystore Security**: Keep `android-release-key.jks` private
- **Production**: Use GitHub Secrets for keystore in CI/CD
- **iOS Certificates**: Store securely, never commit to repository

## Troubleshooting

### Android Issues
- **NDK not found**: Ensure Android SDK and NDK are properly installed
- **Signing failed**: Check keystore path and credentials
- **Build failed**: Verify Java 17 is installed

### iOS Issues
- **No development team**: Set `developmentTeam` in tauri.conf.json
- **Certificate issues**: Ensure valid Apple Developer account
- **Xcode errors**: Update Xcode and command line tools

## File Structure

```
jam-shalat-app/
├── android-release-key.jks          # Android signing keystore
├── setup-mobile.sh                  # Mobile setup script
├── MOBILE_SETUP.md                  # This documentation
├── src-tauri/
│   ├── tauri.conf.json              # Updated with mobile config
│   ├── Cargo.toml                   # Updated with mobile features
│   └── gen/
│       ├── android/                 # Android project (after init)
│       │   └── keystore.properties  # Android signing config
│       └── ios/                     # iOS project (after init)
└── .github/workflows/build.yml      # Updated with mobile builds
```

## Next Steps

1. **For Android**: Ready to build! Run the setup script and test builds
2. **For iOS**: Get Apple Developer account and set development team ID
3. **For Production**: Set up proper secret management for signing keys
4. **For Distribution**: Consider app store publishing workflows

The mobile builds will be automatically generated by GitHub Actions and available as release artifacts alongside the desktop versions.
